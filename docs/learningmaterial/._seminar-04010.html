<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Seminar uke 04: Laplaces og Poissons likninger">

<title>Seminar uke 04: Laplaces og Poissons likninger</title>

<!-- Bootstrap style: bootswatch_journal -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/journal/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:60px;      /* fixed header height for style bootswatch_journal */
  margin:-60px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Læringsmål', 3, None, '___sec0'),
              ('Laplace likning', 1, None, '___sec1'),
              ('Introduksjon til Laplace og Poissons likninger',
               2,
               None,
               '___sec2'),
              ('Oppgave: Laplace operatoren i en dimensjon',
               2,
               None,
               '___sec3'),
              ('Oppgave: Grensebetingelser i en dimensjon', 2, None, '___sec4'),
              ('Oppgave: Laplace-operatoren i to og tre dimensjoner',
               2,
               None,
               '___sec5'),
              ('Litt Vanskeligere Oppgave: Laplace-likning i '
               'sylinderkoordinater',
               2,
               None,
               '___sec6'),
              ('Avansert Oppgave: Laplace-likning og dimensjonalitet',
               2,
               None,
               '___sec7'),
              ('Numerisk løsning av Laplace likning', 2, None, '___sec8'),
              ('Numerisk versjon av Laplace likning', 3, None, '___sec9'),
              ('Jacobi iterasjoner for løsning av Laplace likning',
               3,
               None,
               '___sec10'),
              ('Oppgave: Fortegnet til den diskrete Laplace operatoren',
               2,
               None,
               '___sec11'),
              ('Oppgave: Manuell Jacobi iterasjon', 2, None, '___sec12'),
              ('Oppgave: Numerisk løsning av Laplace likning',
               2,
               None,
               '___sec13')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\renewcommand{\vec}[1]{\mathbf{#1}}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="seminar-04.html">Seminar uke 04: Laplaces og Poissons likninger</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._seminar-04000.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04000.html#___sec0" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Læringsmål</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04001.html#___sec1" style="font-size: 80%;"><b>Laplace likning</b></a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04001.html#___sec2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Introduksjon til Laplace og Poissons likninger</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04002.html#___sec3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Oppgave: Laplace operatoren i en dimensjon</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04003.html#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Oppgave: Grensebetingelser i en dimensjon</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04004.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Oppgave: Laplace-operatoren i to og tre dimensjoner</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04005.html#___sec6" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Litt Vanskeligere Oppgave: Laplace-likning i sylinderkoordinater</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04006.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Avansert Oppgave: Laplace-likning og dimensjonalitet</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04007.html#___sec8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Numerisk løsning av Laplace likning</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04007.html#___sec9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Numerisk versjon av Laplace likning</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04007.html#___sec10" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jacobi iterasjoner for løsning av Laplace likning</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04008.html#___sec11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Oppgave: Fortegnet til den diskrete Laplace operatoren</a></li>
     <!-- navigation toc: --> <li><a href="._seminar-04009.html#___sec12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Oppgave: Manuell Jacobi iterasjon</a></li>
     <!-- navigation toc: --> <li><a href="#___sec13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Oppgave: Numerisk løsning av Laplace likning</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0010"></a>
<!-- !split -->
<div class="panel panel-success">
  <div class="panel-heading">
  <h3 class="panel-title">Oppgave</h3>
  </div>
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec13" class="anchor">Oppgave: Numerisk l&#248;sning av Laplace likning </h2>

<p>
Vi l&#248;ser Laplace likning numerisk i to dimensjoner med det f&#248;lgende programmet:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numba</span> <span style="color: #008000; font-weight: bold">import</span> jit
<span style="color: #AA22FF">@jit</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solvepoisson</span>(b,nrep):
<span style="color: #408080; font-style: italic"># b = boundary conditions, =NaN where we will calculate the values </span>
<span style="color: #408080; font-style: italic"># nrep = number of iterations</span>
<span style="color: #408080; font-style: italic"># returns potential on the same grid as b</span>
    V <span style="color: #666666">=</span> np<span style="color: #666666">.</span>copy(b)
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(V<span style="color: #666666">.</span>flat)): 
        <span style="color: #008000; font-weight: bold">if</span> (np<span style="color: #666666">.</span>isnan(b<span style="color: #666666">.</span>flat[i])):
            V<span style="color: #666666">.</span>flat[i] <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
    Vnew <span style="color: #666666">=</span> np<span style="color: #666666">.</span>copy(V) <span style="color: #408080; font-style: italic"># See comment in text below</span>
    Lx <span style="color: #666666">=</span> b<span style="color: #666666">.</span>shape[<span style="color: #666666">0</span>] <span style="color: #408080; font-style: italic"># x-size of b matrix </span>
    Ly <span style="color: #666666">=</span> b<span style="color: #666666">.</span>shape[<span style="color: #666666">1</span>] <span style="color: #408080; font-style: italic"># y-size of b matrix </span>
    <span style="color: #008000; font-weight: bold">for</span> n <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(nrep):
        <span style="color: #008000; font-weight: bold">for</span> ix <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>,Lx<span style="color: #666666">-1</span>):
            <span style="color: #008000; font-weight: bold">for</span> iy <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>,Ly<span style="color: #666666">-1</span>):
                <span style="color: #008000; font-weight: bold">if</span> (np<span style="color: #666666">.</span>isnan(b[ix,iy])):
                    Vnew[ix,iy] <span style="color: #666666">=</span> (V[ix<span style="color: #666666">-1</span>,iy]<span style="color: #666666">+</span>V[ix<span style="color: #666666">+1</span>,iy]<span style="color: #666666">+</span>V[ix,iy<span style="color: #666666">-1</span>]<span style="color: #666666">+</span>V[ix,iy<span style="color: #666666">+1</span>])<span style="color: #666666">/4</span>
                <span style="color: #008000; font-weight: bold">else</span>:
                    Vnew[ix,iy] <span style="color: #666666">=</span> V[ix,iy]
        V,Vnew <span style="color: #666666">=</span> Vnew,V <span style="color: #408080; font-style: italic"># Swap points to arrays V and Vnew </span>
    <span style="color: #008000; font-weight: bold">return</span> V
</pre></div>
<p>
Vi definerer grensebetingelsene i <code>b</code>-matrisen:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>L <span style="color: #666666">=</span> <span style="color: #666666">40</span>
b <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((L,L),<span style="color: #008000">float</span>) 
b[:] <span style="color: #666666">=</span> np<span style="color: #666666">.</span>float(<span style="color: #BA2121">&#39;nan&#39;</span>)
b[<span style="color: #666666">0</span>,:] <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
b[L<span style="color: #666666">-1</span>,:] <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
b[:,<span style="color: #666666">0</span>] <span style="color: #666666">=</span> <span style="color: #666666">1.0</span>
b[:,L<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
plt<span style="color: #666666">.</span>imshow(b)
</pre></div>
<p>
Og s&#229; finner vi l&#248;sningen ved &#229; kalle funksjonen <code>solvepoisson</code>:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>nrep <span style="color: #666666">=</span> <span style="color: #666666">2000</span>
V <span style="color: #666666">=</span> solvepoisson(b,nrep)
plt<span style="color: #666666">.</span>imshow(V)
plt<span style="color: #666666">.</span>colorbar()
</pre></div>
<p>
<b>a)</b>
Hva blir l&#248;sningen hvis grensebetingelsen er \( V=0 \) p&#229; alle ytterkantene?

<p>
<!-- --- begin answer of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_8_1" style="font-size: 80%;"></a>
<a href="#exer_8_1" data-toggle="collapse">
<b>Answer.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_8_1">

<p>
0

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end answer of exercise --- -->

<p>
<b>b)</b>
Hva blir l&#248;sningen hvis grensebetingelsene er \( V=0 \) p&#229; alle ytterkantene og \( V=1 \) i et punkt i midten?

<p>
<!-- --- begin answer of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_8_2" style="font-size: 80%;"></a>
<a href="#exer_8_2" data-toggle="collapse">
<b>Answer.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_8_2">

<p>
<br /><br /><center><p><img src="fig-laplaceequation/laplaceequation-activelearning-numsolve-010.png" align="bottom" width=500 style='width: 100%; max-width: 500'></p></center><br /><br />

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end answer of exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>c)</b>
Hva blir l&#248;sningen hvis grensebetingelsene er \( V=0 \) p&#229; alle ytterkantene og \( V=1 \) p&#229; en sirkel i midten med radius \( 3 \)?

<p>
<!-- --- begin answer of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_8_3" style="font-size: 80%;"></a>
<a href="#exer_8_3" data-toggle="collapse">
<b>Answer.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_8_3">

<p>
<br /><br /><center><p><img src="fig-laplaceequation/laplaceequation-activelearning-numsolve-020.png" align="bottom" width=500 style='width: 100%; max-width: 500'></p></center><br /><br />

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end answer of exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>d)</b>
Hvordan finner du det elektriske feltet fra potensialet? Plot det elektriske feltet i de tre tilfellene ovenfor.

<p>
<!-- --- begin answer of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_8_4" style="font-size: 80%;"></a>
<a href="#exer_8_4" data-toggle="collapse">
<b>Answer.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_8_4">

<p>
<br /><br /><center><p><img src="fig-laplaceequation/laplaceequation-activelearning-numsolve-030.png" align="bottom" width=500 style='width: 100%; max-width: 500'></p></center><br /><br />

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end answer of exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>e)</b>
Hvordan kan du finne det elektriske potensialet langs en linje langs \( x \)-aksen? Finn og plot det elektriske potensialet som funksjon av \( x \) for oppgave (b) og (c) ovenfor. Hva slags funksjonsform er det rimelig &#229; sammenlikne med i dette tilfellet?

<p>
<!-- --- begin answer of exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_8_5" style="font-size: 80%;"></a>
<a href="#exer_8_5" data-toggle="collapse">
<b>Answer.</b>
</a>
<div class="collapse-group">
<p><div class="collapse" id="exer_8_5">

<p>
<br /><br /><center><p><img src="fig-laplaceequation/laplaceequation-activelearning-numsolve-040.png" align="bottom" width=500 style='width: 100%; max-width: 500'></p></center><br /><br />

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end answer of exercise --- -->

<p>
<!-- removed !bsol ... !esol environment (because of the command-line option --without_solutions)
 -->
<p>
<b>f)</b>
Din venn Q sier at han har funnet opp en genial m&#229;te &#229; beskytte seg mot elektriske felt --- ved &#229; sette seg inni i lukket overflate som har et konstant elektrisk potensiale. Stemmer dette? Bruk resultater du har funnet her til &#229; argumentere for eller i mot dette. Hvordan tror du dette kan realiseres? (Vi skal se p&#229; dette i de neste ukene).

<p>
</div>
</div>

<!-- --- end exercise --- -->

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._seminar-04009.html">&laquo;</a></li>
  <li><a href="._seminar-04000.html">1</a></li>
  <li><a href="">...</a></li>
  <li><a href="._seminar-04002.html">3</a></li>
  <li><a href="._seminar-04003.html">4</a></li>
  <li><a href="._seminar-04004.html">5</a></li>
  <li><a href="._seminar-04005.html">6</a></li>
  <li><a href="._seminar-04006.html">7</a></li>
  <li><a href="._seminar-04007.html">8</a></li>
  <li><a href="._seminar-04008.html">9</a></li>
  <li><a href="._seminar-04009.html">10</a></li>
  <li class="active"><a href="._seminar-04010.html">11</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

